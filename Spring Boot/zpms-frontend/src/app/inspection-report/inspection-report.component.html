<div class="container my-4 report-container">
  <h2 class="text-center text-primary mb-4"><i class="bi bi-file-earmark-bar-graph-fill me-2"></i>‡§Ö‡§Ç‡§ó‡§£‡§µ‡§æ‡§°‡•Ä ‡§â‡§¶‡•ç‡§¶‡§ø‡§∑‡•ç‡§ü‡§æ‡§Ç‡§ö‡§æ ‡§Ö‡§π‡§µ‡§æ‡§≤</h2>

  <form [formGroup]="filterForm" class="card p-3 shadow-sm mb-4 rounded-4">
    <div class="row g-3 align-items-end">
      <div class="col-md-3">
        <label class="form-label fw-semibold">‡§§‡§æ‡§≤‡•Å‡§ï‡§æ ‡§®‡§ø‡§µ‡§°‡§æ</label>
        <select class="form-select"
                formControlName="taluka"
                (change)="filterForm.get('anganwadiNumber')?.setValue('')">
          <option value="">‡§∏‡§∞‡•ç‡§µ ‡§§‡§æ‡§≤‡•Å‡§ï‡•á</option>
          <option *ngFor="let talukaName of uniqueTalukas" [value]="talukaName">{{ talukaName }}</option>
        </select>
      </div>

      <div class="col-md-3">
        <label class="form-label fw-semibold">‡§Ö‡§Ç‡§ó‡§£‡§µ‡§æ‡§°‡•Ä ‡§®‡§ø‡§µ‡§°‡§æ</label>
        <select class="form-select" formControlName="anganwadiNumber">
          <option value="">‡§∏‡§∞‡•ç‡§µ ‡§Ö‡§Ç‡§ó‡§£‡§µ‡§æ‡§°‡•Ä</option>
          <option *ngFor="let aw of uniqueAnganwadisForSelectedTaluka" [value]="aw.number">
            {{ aw.name }} ({{ aw.number }})
          </option>
        </select>
      </div>

      <div class="col-md-2">
        <label class="form-label fw-semibold">‡§™‡§æ‡§∏‡•Ç‡§®</label>
        <input type="date" class="form-control" formControlName="fromDate">
      </div>

      <div class="col-md-2">
        <label class="form-label fw-semibold">‡§™‡§∞‡•ç‡§Ø‡§Ç‡§§</label>
        <input type="date" class="form-control" formControlName="toDate">
      </div>

      <div class="col-md-2 text-end">
        <button type="button" class="btn btn-primary me-2 w-100" (click)="showData()" [disabled]="isLoading">
          <i class="bi bi-search me-1"></i>
          <span *ngIf="isLoading" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
          ‡§∂‡•ã‡§ß‡§æ
        </button>
        <button type="button" class="btn btn-outline-danger w-100 mt-2" (click)="clearFilters()" [disabled]="isLoading">
          <i class="bi bi-x-circle"></i> ‡§ï‡•ç‡§≤‡§ø‡§Ö‡§∞
        </button>
      </div>
    </div>
  </form>

  <div *ngIf="isLoading" class="text-center my-3">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <div *ngIf="errorMessage && !isLoading" class="alert alert-danger my-3" role="alert">
    {{ errorMessage }}
  </div>

  <div *ngIf="!isLoading && !errorMessage && tableData.length === 0 && (filterForm.dirty || filterForm.touched || allAnganwadis.length > 0)" class="alert alert-warning my-3">
    ‡§§‡•Å‡§Æ‡§ö‡•ç‡§Ø‡§æ ‡§®‡§ø‡§ï‡§∑‡§æ‡§Ç‡§∂‡•Ä ‡§ú‡•Å‡§≥‡§£‡§æ‡§∞‡§æ ‡§ï‡•ã‡§£‡§§‡§æ‡§π‡•Ä ‡§°‡•á‡§ü‡§æ ‡§Ü‡§¢‡§≥‡§≤‡§æ ‡§®‡§æ‡§π‡•Ä.
  </div>

  <div *ngIf="!isLoading && !errorMessage && allAnganwadis.length === 0 && !filterForm.dirty && !filterForm.touched" class="alert alert-info my-3">
    ‡§∏‡§ß‡•ç‡§Ø‡§æ ‡§Ö‡§Ç‡§ó‡§£‡§µ‡§æ‡§°‡•Ä‡§ö‡§æ ‡§ï‡•ã‡§£‡§§‡§æ‡§π‡•Ä ‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§æ‡§π‡•Ä.
  </div>

  <div class="table-responsive">
    <table class="table table-bordered table-hover align-middle text-center" *ngIf="!isLoading && !errorMessage && tableData.length > 0">
      <thead class="table-primary">
        <tr>
          <th>‡§Ö. ‡§ï‡•ç‡§∞.</th>
          <th>‡§Ö‡§Ç‡§ó‡§£‡§µ‡§æ‡§°‡•Ä ‡§ï‡•ç‡§∞.</th>
          <th>‡§§‡§æ‡§≤‡•Å‡§ï‡§æ</th>
          <th>‡§Ö‡§Ç‡§ó‡§£‡§µ‡§æ‡§°‡•Ä ‡§®‡§æ‡§µ</th>
          <th>‡§≠‡•á‡§ü ‡§¶‡§ø‡§®‡§æ‡§Ç‡§ï</th>
          <th>‡§ï‡•É‡§§‡•Ä</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let row of tableData; let i = index">
          <td>{{ i + 1 }}</td>
          <td>{{ row.anganwadiNumber }}</td>
          <td>{{ row.taluka }}</td>
          <td>{{ row.anganwadiHelperName }}</td>
          <td>{{ row.inspectionDate | date:'dd-MM-yyyy' }}</td>
          <td>
            <a class="btn btn-sm btn-outline-primary me-1"
               [routerLink]="['/anganwadi-form', row.id]">
              üìù ‡§≠‡§∞‡§æ
            </a>
            <button class="btn btn-sm btn-outline-secondary" (click)="viewReportDetails(row)">
              üëÅ ‡§™‡§π‡§æ
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
